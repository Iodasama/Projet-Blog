{% extends "Admin/base.html.twig" %}

{% block metatitle%} La Chine aux rayons X : Your articles page {% endblock %}


{% block content %}
    {% for message in app.flashes('success') %}
        <div class="success-message">
            {{ message }}
        </div>
    {% endfor %}
    <main>
        <h1>Get Your favorite article  </h1>

        <table class="" id="myTable">
            <thead>
            <tr>
                <td>Id</td>
                <td>Titre</td>
                <td>Content</td>
                <td>Description</td>
                <td>Image</td>
                <td>Date</td>
                <td>Est publié ?</td>
                <td>Modifier article</td>
                <td> Actions</td>
            </tr>
            </thead>
            <tbody>
        {% for article in articles %}
                <tr>
                    <td><p class="poke2">{{ article.id }}</p></td>
                    <td><p class="poke2">{{ article.title }}</p></td>
                    {# dans twig on accede a la propriété title de l'instance de la classe article requete sql#}
                    <td><p class="poke2">{{ article.content}}</p></td>
                    <td><p class="poke2">{{ article.description }}</p></td>
{#                    <td><img class="admin_image" src="{{ article.image }}"></td>#}
                    <td><img class="admin_image" src="{{ asset('images/'~article.image) }}"></td>
                    <td><p class="poke2">{{ article.createdAt |date("Y/m/d") }}</p></td>
                    <td> {% if article and article.isPublished %}
                            <p>Oui</p>
                        {% else %}
                            <p>Non</p>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('admin_article_update_formbuilder', {id:article.id}) }}"><i class="fa-solid fa-pen-to-square green"></i></a>
                        <a href="{{ path('delete_article', {id:article.id}) }}"><i class="fa-solid fa-trash-can green"></i></a>
                    </td>
                    <td>
                        <p class="js-admin-article-delete">Suppress</p>

                        <div class="admin-article-popup-delete">
                            <p>Voulez vous vraiment supprimer ?</p>

                            <a href="{{ path('delete_article', {id: article.id}) }}"><i class="fa-solid fa-trash-can green"></i></a>
                        </div>
                        <div class= "noDelete"> <p>Ne pas supprimer</p>
                        </div>
                    </td>
                </tr>

        {% endfor %}
            </tbody>
        </table>



{#            <a href="{{ path('article_update', {id:article.id}) }}">Update Your Article</a>#}
    </main>


{% endblock %}

{% block javascript %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<script src="https://cdn.datatables.net/2.1.4/js/dataTables.min.js"></script>
<script>
let table = new DataTable('#myTable');
</script>
{% endblock %}